import re
from ciscoconfparse import CiscoConfParse

parse = CiscoConfParse("/home/hrb/github/pynet/ciscoconfparse/config.txt")
objects = parse.find_objects("^crypto map CRYPTO")

def findParentAndChildern():
    count = 0
    for obj in objects:
       print "Parent is:"
       print obj.text
       print""
       parent = objects[count]
       list_a= parent.children
       print "Childerns are:"
       for child in list_a:
           print child.text
           print""
    count = count+1

    

def findPFSgroup2():
    print "#################"
    print "CRYPTO maps with PFSgroup2 are:\n"
    for obj in objects:
       if obj.re_search_children(r"set pfs group2"):
           print obj.text  
           print""
    

def findNOTAES():
    count = 0
    print "#################"
    print "CRYPTO maps with NO AES:\n"
    for obj in objects:
       if not obj.re_search_children(r"set transform-set AES-SHA"):
           print obj.text 
           parent = objects[count]
           list_a = parent.children
           for child in list_a:
               a = str(child)
               print(re.search(r".set transform-set+", a))
            

    
def main():
    findParentAndChildern()
    findPFSgroup2()
    findNOTAES()

main()
