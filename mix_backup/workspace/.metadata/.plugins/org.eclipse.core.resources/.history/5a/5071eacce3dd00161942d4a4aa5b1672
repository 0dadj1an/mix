import re
from ciscoconfparse import CiscoConfParse

parse = CiscoConfParse("/home/hrb/github/pynet/ciscoconfparse/config.txt")
objects = parse.find_objects("^crypto map CRYPTO")


def findParentAndChildern():
    for obj in objects:
       print "Parent is:"
       print obj.text
       print""
       parent = objects[objects.index(obj)]
       list_a= parent.children
       print "Childerns are:"
       for child in list_a:
           print child.text
           print""
    

    

def findPFSgroup2():
    print "#################"
    print "CRYPTO maps with PFSgroup2 are:\n"
    for obj in objects:
       if obj.re_search_children(r"set pfs group2"):
           print obj.text 
            
           
    

def findNOTAES():
    print "#################"
    print "CRYPTO maps with NO AES:\n"
    for obj in objects:
       if not obj.re_search_children(r"set transform-set AES-SHA"):
           print obj.text
           parent = objects[objects.index(obj)]
           list_a = parent.children
           for ee in list_a:
               a = ee.find_children('^set transform-set')
               print a
def main():
    findParentAndChildern()
    findPFSgroup2()
    findNOTAES()

main()
