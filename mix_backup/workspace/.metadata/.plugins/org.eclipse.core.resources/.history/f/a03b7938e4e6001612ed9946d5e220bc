

import cpauto
import sys


class CheckPointFinder(object):
    def __init__(self, session):
        self.session = session
            
        
    def findNetworkUIDs(self):
        networks = cpauto.Network(self.session)
        order = []
        output = networks.show_all(500, 0,order, 'uid')
        print output
        output_dictionary = output.json()
        print output_dictionary
        helplist = output_dictionary['objects']
        # old way to find it when there is no parameter in method show_all
        '''
        finallistofnetworksuid = []
        counter=0
        while counter < len(helplist):
             obj = helplist[counter]
             for item in obj:
                 if item == 'uid':
                      a = obj[item]
                      finallistofnetworksuid.append(a)
                      
             counter = counter + 1
        '''       
        return helplist
    
    def findHostUIDs(self):
        hosts = cpauto.Host(self.session)
        order = []
        output = hosts.show_all(500, 0,order, 'uid')
        output_dictionary = output.json()
        helplist = output_dictionary['objects']
        return helplist
        
    
    def isNetworkExists(self, uid, ip, mask):
            network = cpauto.Network(self.session)
            output = network.show(uid)
            outputdictfromserver = output.json()
            IP = outputdictfromserver['subnet4'] 
            MASK = outputdictfromserver['mask-length4']
            
            if (str(IP) == ip and str(MASK) == mask):
                 return True
            else: 
                 return False
             
    
        
def main():
        
    
    session = cpauto.CoreClient('admin', 'cisco123', '192.168.0.250')
          
    output = session.login()
    print output.status_code
    finder = CheckPointFinder(session)
    a = finder.findNetworkUIDs()
    check = True
    for item in a:
        if finder.isNetworkExists(item, '172.16.10.2', '24'):
            print "IP exists"
        else:
            check = False
    
    if check == False:
        print "IP does dinot exists"
    b = finder.findHostUIDs()
    #print b
        
    output = session.logout()
    print output.status_code
    
        
if __name__ == "__main__":
    main()
    
        
        
        
        
        


    
    
        
        
         
         
         
    
        
        